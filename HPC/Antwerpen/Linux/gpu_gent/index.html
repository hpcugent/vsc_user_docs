
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>HPC-UGent GPU clusters - VSC User Documentation - Antwerpen (Linux)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hpc-ugent-gpu-clusters" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="VSC User Documentation - Antwerpen (Linux)" class="md-header__button md-logo" aria-label="VSC User Documentation - Antwerpen (Linux)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            VSC User Documentation - Antwerpen (Linux)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              HPC-UGent GPU clusters
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="VSC User Documentation - Antwerpen (Linux)" class="md-nav__button md-logo" aria-label="VSC User Documentation - Antwerpen (Linux)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    VSC User Documentation - Antwerpen (Linux)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        Introduction to HPC
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../account/" class="md-nav__link">
        Getting an HPC Account
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../connecting/" class="md-nav__link">
        Connecting to the HPC infrastructure
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../running_batch_jobs/" class="md-nav__link">
        Running batch jobs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../running_interactive_jobs/" class="md-nav__link">
        Running interactive jobs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../running_jobs_with_input_output_data/" class="md-nav__link">
        Running jobs with input/output data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../multi_core_jobs/" class="md-nav__link">
        Multi core jobs/Parallel Computing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../web_portal/" class="md-nav__link">
        Using the HPC-UGent web portal
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../xdmod/" class="md-nav__link">
        XDMoD portal
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../sites/hpc_policies/" class="md-nav__link">
        HPC Policies
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../FAQ/" class="md-nav__link">
        Frequently Asked Questions
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_13" type="checkbox" id="__nav_13" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_13">
          Advanced topics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          Advanced topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fine_tuning_job_specifications/" class="md-nav__link">
        Fine-tuning Job Specifications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../multi_job_submission/" class="md-nav__link">
        Multi-job submission
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../compiling_your_software/" class="md-nav__link">
        Compiling and testing your software on the HPC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../program_examples/" class="md-nav__link">
        Program examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jobscript_examples/" class="md-nav__link">
        Job script examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../best_practices/" class="md-nav__link">
        Best Practices
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_14" type="checkbox" id="__nav_14" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_14">
          Appendices
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Appendices" data-md-level="1">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          Appendices
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../quick_reference_guide/" class="md-nav__link">
        Appendix A - HPC Quick Reference Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../torque_options/" class="md-nav__link">
        Appendix B - TORQUE options
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../useful_linux_commands/" class="md-nav__link">
        Appendix C - Useful Linux Commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#submitting-jobs" class="md-nav__link">
    Submitting jobs
  </a>
  
    <nav class="md-nav" aria-label="Submitting jobs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interactive-jobs" class="md-nav__link">
    Interactive jobs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hardware" class="md-nav__link">
    Hardware
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requesting-gpu-resources" class="md-nav__link">
    Requesting (GPU) resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attention-points" class="md-nav__link">
    Attention points
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-with-gpu-support" class="md-nav__link">
    Software with GPU support
  </a>
  
    <nav class="md-nav" aria-label="Software with GPU support">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gromacs" class="md-nav__link">
    GROMACS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#horovod" class="md-nav__link">
    Horovod
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch" class="md-nav__link">
    PyTorch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorflow" class="md-nav__link">
    TensorFlow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alphafold" class="md-nav__link">
    AlphaFold
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-help" class="md-nav__link">
    Getting help
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="hpc-ugent-gpu-clusters"><abbr title="High Performance Computing, high performance computing and multiple-task computing on a supercomputer.">HPC</abbr>-UGent GPU clusters<a class="headerlink" href="#hpc-ugent-gpu-clusters" title="Permanent link">#</a></h1>
<h2 id="submitting-jobs">Submitting jobs<a class="headerlink" href="#submitting-jobs" title="Permanent link">#</a></h2>
<p>To submit jobs to the <code>joltik</code> GPU <abbr title="A group of compute nodes.">cluster</abbr>, where each <abbr title="A node attribute is a non-quantitative aspect of a node. Attributes typically describe the node itself or possibly aspects of various node resources such as processors or memory. While it is probably not optimal to aggregate node and resource attributes together in this manner, it is common practice. Common node attributes include processor architecture, operating system, and processor speed. Jobs often specify that resources be allocated from nodes possessing certain node attributes.">node</abbr> provides 4
NVIDIA V100 GPUs (each with 32GB of GPU <abbr title="A quantity of physical memory (RAM). Memory is provided by compute nodes. It is required as a constraint or consumed as a consumable resource by jobs. Within Moab, memory is tracked and reported in megabytes (MB).">memory</abbr>), use:</p>
<pre><code>$ <b>module swap cluster/joltik</b>
</code></pre>

<p>To submit to the <code>accelgor</code> GPU <abbr title="A group of compute nodes.">cluster</abbr>, where each <abbr title="A node attribute is a non-quantitative aspect of a node. Attributes typically describe the node itself or possibly aspects of various node resources such as processors or memory. While it is probably not optimal to aggregate node and resource attributes together in this manner, it is common practice. Common node attributes include processor architecture, operating system, and processor speed. Jobs often specify that resources be allocated from nodes possessing certain node attributes.">node</abbr> provides 4
NVIDIA A100 GPUs (each with 80GB GPU <abbr title="A quantity of physical memory (RAM). Memory is provided by compute nodes. It is required as a constraint or consumed as a consumable resource by jobs. Within Moab, memory is tracked and reported in megabytes (MB).">memory</abbr>), use:</p>
<pre><code>$ <b>module swap cluster/accelgor</b>
</code></pre>

<p>Then use the familiar <code>qsub</code>, <code>qstat</code>, etc. commands, taking into
account the guidelines outlined in
section <a href="./#requesting-gpu-resources">Requesting (GPU) resources</a>.</p>
<h3 id="interactive-jobs">Interactive jobs<a class="headerlink" href="#interactive-jobs" title="Permanent link">#</a></h3>
<p>To interactively experiment with GPUs, you can submit an interactive job
using <code>qsub -I</code> (and request one or more GPUs, see
section <a href="./#requesting-gpu-resources">Requesting (GPU) resources</a>).</p>
<p>Note that due to a bug in Slurm you will currently not be able to be
able to interactively use <abbr title="MPI stands for Message-Passing Interface. It supports a parallel programming method designed for distributed memory systems, but can also be used well on shared memory systems.">MPI</abbr> software that requires access to the GPUs.
If you need this, please contact use via hpc@uantwerpen.be.</p>
<h2 id="hardware">Hardware<a class="headerlink" href="#hardware" title="Permanent link">#</a></h2>
<p>See <a href="https://www.ugent.be/hpc/en/infrastructure">https://www.ugent.be/hpc/en/infrastructure</a>.</p>
<h2 id="requesting-gpu-resources">Requesting (GPU) resources<a class="headerlink" href="#requesting-gpu-resources" title="Permanent link">#</a></h2>
<p>There are 2 main ways to ask for GPUs as part of a job:</p>
<ul>
<li>
<p>Either as a <abbr title="A node attribute is a non-quantitative aspect of a node. Attributes typically describe the node itself or possibly aspects of various node resources such as processors or memory. While it is probably not optimal to aggregate node and resource attributes together in this manner, it is common practice. Common node attributes include processor architecture, operating system, and processor speed. Jobs often specify that resources be allocated from nodes possessing certain node attributes.">node</abbr> property (similar to the number of cores per <abbr title="A node attribute is a non-quantitative aspect of a node. Attributes typically describe the node itself or possibly aspects of various node resources such as processors or memory. While it is probably not optimal to aggregate node and resource attributes together in this manner, it is common practice. Common node attributes include processor architecture, operating system, and processor speed. Jobs often specify that resources be allocated from nodes possessing certain node attributes.">node</abbr>
    specified via <code>ppn</code>) using <code>-l nodes=X:ppn=Y:gpus=Z</code> (where the
    <code>ppn=Y</code> is optional), or as a separate resource request (similar to
    the amount of <abbr title="A quantity of physical memory (RAM). Memory is provided by compute nodes. It is required as a constraint or consumed as a consumable resource by jobs. Within Moab, memory is tracked and reported in megabytes (MB).">memory</abbr>) via <code>-l gpus=Z</code>. Both notations give exactly
    the same result. The <code>-l gpus=Z</code> is convenient is you only need one
    <abbr title="A node attribute is a non-quantitative aspect of a node. Attributes typically describe the node itself or possibly aspects of various node resources such as processors or memory. While it is probably not optimal to aggregate node and resource attributes together in this manner, it is common practice. Common node attributes include processor architecture, operating system, and processor speed. Jobs often specify that resources be allocated from nodes possessing certain node attributes.">node</abbr> and you are fine with the default number of cores per GPU. The
    <code>-l nodes=...:gpus=Z</code> notation is required if you want to run with
    full control or in multinode cases like <abbr title="MPI stands for Message-Passing Interface. It supports a parallel programming method designed for distributed memory systems, but can also be used well on shared memory systems.">MPI</abbr> jobs. If you do not
    specify the number of GPUs by just using <code>-l gpus</code>, you get by
    default 1 GPU.</p>
</li>
<li>
<p>As a resource of it's own, via <code>--gpus X</code>. In this case however, you
    are <em>not</em> guaranteed that the GPUs are on the same <abbr title="A node attribute is a non-quantitative aspect of a node. Attributes typically describe the node itself or possibly aspects of various node resources such as processors or memory. While it is probably not optimal to aggregate node and resource attributes together in this manner, it is common practice. Common node attributes include processor architecture, operating system, and processor speed. Jobs often specify that resources be allocated from nodes possessing certain node attributes.">node</abbr>, so your
    script or code must be able to deal with this.</p>
</li>
</ul>
<!-- %  TODO We are providing a parallel wrapper ``wurker'' in the ``vsc-mympirun'' module to help with this
%  (and with other more usual parallel work, similar to the usual ``worker'' or ``atools'' tools).
%\item As a partial node resource, via ``-l nodes=...:mps=Z'' or ``-l mps=Z''.
%  This triggers the Multi-Process Service (MPS, see https://docs.nvidia.com/deploy/pdf/CUDA_Multi_Process_Service_Overview.pdf),
%  a way to ask for part of a GPU. The ``mps=`` value is a percentage of a GPU, and when submitting the job,
%  you typically ask for a multiple of 100. The jobscript can then hand out portions of this (e.g. 50 per task) to the actual work.
%  This is useful when a single application or MPI task cannot utilise a single/full GPU, and there are many other similar tasks that
%  need to be processed or increasing the MPI ranks gives a speedup (e.g. when there is a significant portion of CPU work in the code).
%  Unfortunately, this is not a silver bullet, and might require some experimenting to found out any potential benefits and proper tuning.
%  TODO: how can a user now that an application is not using the full gpu resources?
%  TODO this needs testing and there are some constraints (eg one mps job per node and thus one user per node using MPS)
%  TODO needs proper integration with mypmirun / wurker
%  TODO add separate section on MPS -->

<p>Some background:</p>
<ul>
<li>
<p>The GPUs are constrained to the jobs (like the <abbr title="A central processing unit. A CPU is a consumable resource. A compute node typically contains one or more CPUs">CPU</abbr> cores), but do
    not run in so-called "exclusive" mode.</p>
</li>
<li>
<p>The GPUs run with the so-called "persistence daemon", so the GPUs is
    not re-initialised between jobs.</p>
</li>
</ul>
<!-- %  TODO: we need to fix this in the pro/epilogue scripts? is this similar to regular RAM? -->

<!-- %TODO: add examples ? -->

<h2 id="attention-points">Attention points<a class="headerlink" href="#attention-points" title="Permanent link">#</a></h2>
<p>Some important attention points:</p>
<ul>
<li>
<p>For <abbr title="MPI stands for Message-Passing Interface. It supports a parallel programming method designed for distributed memory systems, but can also be used well on shared memory systems.">MPI</abbr> jobs, we recommend the (new) wrapper <code>mypmirun</code> from the
    <code>vsc-mympirun</code> module (<code>pmi</code> is the background mechanism to start
    the <abbr title="MPI stands for Message-Passing Interface. It supports a parallel programming method designed for distributed memory systems, but can also be used well on shared memory systems.">MPI</abbr> tasks, and is different from the usual <code>mpirun</code> that is used
    by the <code>mympirun</code> wrapper). At some later point, we <em>might</em> promote
    the <code>mypmirun</code> tool or rename it, to avoid the confusion in the
    naming).</p>
</li>
<li>
<p>Sharing GPUs requires MPS. The Slurm built-in MPS does not really do
    want you want, so we will provide integration with <code>mypmirun</code> and
    <code>wurker</code>.</p>
</li>
<li>
<p>For parallel work, we are working on a <code>wurker</code> wrapper from the
    <code>vsc-mympirun</code> module that supports GPU placement and MPS, without
    any limitations wrt the requested resources (i.e. also support the
    case where GPUs are spread heterogenous over nodes from using the
    <code>--gpus Z</code> option).</p>
</li>
<li>
<p>Both <code>mypmirun</code> and <code>wurker</code> will try to do the most optimised
    placement of cores and tasks, and will provide 1 (optimal) GPU per
    task/<abbr title="MPI stands for Message-Passing Interface. It supports a parallel programming method designed for distributed memory systems, but can also be used well on shared memory systems.">MPI</abbr> rank, and set one so-called <em>visible device</em> (i.e.
    <code>CUDA_VISIBLE_DEVICES</code> only has 1 ID). The actual devices are not
    constrained to the ranks, so you can access all devices requested in
    the job. <em>We know that at this moment, this is not working properly, but we are working on this. We advise against trying to fix this yourself.</em></p>
</li>
</ul>
<!-- % TODO: this is still not the case, due to bugs in slurm. For now, you will probably do not get optimal placement and/or more
  %than one visible device.
  %TODO: we need an easy way to toggle this behaviour.
  %TODO: should be configurable from qsub somehow. Or we need to wait for fix or patch it ourself. -->

<!-- %TODO: add section on mypmirun, but has nothing to do with joltik. It works on all ugent/slurm clusters with and supports intelmpi.
%Main advantages are single tool instead of per-MPI mpirun flavour, improved accouting and faster startup. -->

<h2 id="software-with-gpu-support">Software with GPU support<a class="headerlink" href="#software-with-gpu-support" title="Permanent link">#</a></h2>
<p>Use <code>module avail</code> to check for centrally installed software.</p>
<p>The subsections below only cover a couple of installed software
packages, more are available.</p>
<h3 id="gromacs">GROMACS<a class="headerlink" href="#gromacs" title="Permanent link">#</a></h3>
<p>Please consult <code>module avail GROMACS</code> for a list of installed versions.</p>
<h3 id="horovod">Horovod<a class="headerlink" href="#horovod" title="Permanent link">#</a></h3>
<p>Horovod can be used for (multi-<abbr title="A node attribute is a non-quantitative aspect of a node. Attributes typically describe the node itself or possibly aspects of various node resources such as processors or memory. While it is probably not optimal to aggregate node and resource attributes together in this manner, it is common practice. Common node attributes include processor architecture, operating system, and processor speed. Jobs often specify that resources be allocated from nodes possessing certain node attributes.">node</abbr>) multi-GPU TensorFlow/PyTorch
calculations.</p>
<p>Please consult <code>module avail Horovod</code> for a list of installed versions.</p>
<p>Horovod supports TensorFlow, Keras, PyTorch and MxNet (see
<a href="https://github.com/horovod/horovod#id9">https://github.com/horovod/horovod#id9</a>), but should be run as an <abbr title="MPI stands for Message-Passing Interface. It supports a parallel programming method designed for distributed memory systems, but can also be used well on shared memory systems.">MPI</abbr>
application with <code>mypmirun</code>. (Horovod also provides it's own wrapper
<code>horovodrun</code>, not sure if it handles placement and others correctly).</p>
<p>At least for simple TensorFlow benchmarks, it looks like Horovod is a
bit faster than usual autodetect multi-GPU TensorFlow without horovod,
but it comes at the cost of the code modifications to use horovod.</p>
<!-- 
%TODO: use NCCL version (only check is to export NCCL_DEBUG=INFO)
%TODO: NCCL tuning https://docs.nvidia.com/deeplearning/sdk/nccl-developer-guide/docs/env.html
%-> joltik: NCCL_NET_GDR_LEVEL=4 -> in environment -->

<h3 id="pytorch">PyTorch<a class="headerlink" href="#pytorch" title="Permanent link">#</a></h3>
<p>Please consult <code>module avail PyTorch</code> for a list of installed versions.</p>
<h3 id="tensorflow">TensorFlow<a class="headerlink" href="#tensorflow" title="Permanent link">#</a></h3>
<p>Please consult <code>module avail TensorFlow</code> for a list of installed
versions.</p>
<p><strong>Note: for running TensorFlow calculations on multiple GPUs and/or on more than one workernode, use <code>Horovod</code>, see section <a href="./#horovod">Horovod</a>.</strong></p>
<h4 id="example-tensorflow-job-script">Example TensorFlow job script<a class="headerlink" href="#example-tensorflow-job-script" title="Permanent link">#</a></h4>
<p><center>-- TensorFlow_GPU.sh --</center>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1">#PBS -l walltime=5:0:0</span>
<span class="c1">#PBS -l nodes=1:ppn=quarter:gpus=1</span>

module load TensorFlow/2.6.0-foss-2021a-CUDA-11.3.1

<span class="nb">cd</span> <span class="nv">$PBS_O_WORKDIR</span>
python example.py
</code></pre></div></p>
<!-- %TODO: add intel cpu params (only for cpu, but mention it anyway) and data format (channel_first  / NCHW)
% OMP_NUM_THREADS=$PBS_VARIABLE_FOR_CORES
% KMP_BLOCKTIME=0
% KMP_AFFINITY="granularity=fine,verbose,compact,1,0"
% KMP_SETTINGS=1

%TODO: quid tensocores and bfloat16 etc etc?

%TODO: even on single node, horovod is faster (5\%) with nccl? (at least for simple benchmark) -->

<h3 id="alphafold">AlphaFold<a class="headerlink" href="#alphafold" title="Permanent link">#</a></h3>
<p>Please consult <code>module avail AlphaFold</code> for a list of installed
versions.</p>
<p>For more information on using AlphaFold, we strongly recommend the
VIB-UGent course available at
<a href="https://elearning.bits.vib.be/courses/alphafold">https://elearning.bits.vib.be/courses/alphafold</a>.</p>
<h2 id="getting-help">Getting help<a class="headerlink" href="#getting-help" title="Permanent link">#</a></h2>
<p>In case of questions or problems, please contact the UAntwerpen-<abbr title="High Performance Computing, high performance computing and multiple-task computing on a supercomputer.">HPC</abbr> via hpc@uantwerpen.be, and clearly
indicate that your question relates to the <code>joltik</code> <abbr title="A group of compute nodes.">cluster</abbr> by adding
<code>[joltik]</code> in the email subject.</p>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top", "navigation.expand", "navigation.tracking", "toc.follow", "navigation.sections", "navigation.instant", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>